2021 화이트햇 콘테스트 참가자 분들께 안내 드립니다.

가상머신 이미지 다운로드 링크가 포함된 PDF 파일을 첨부 파일로 보내드립니다.

기존 메일 링크는 몇몇 메일 서버에서 스팸으로 차단되는 이슈가 발생하여, PDF 파일로 수정된 링크로 재발송 드립니다. 기존에 파일 받으신 분들은 다시 받지 않으셔도 되며, 파일의 해시값을 제공해드리오니, 참고하시기 바랍니다.

PDF 파일의 암호는  withcon2021!  입니다

감사합니다.  

가상머신 암호: white4t_VICTIM!@!@#$
whiteh4t_VICTIM!@!@#$

9시 대회시작.
가상머신 다운받는게 1시간.
비번까먹어서 ㅈㄴ 찾다가 10:37분 로그인 

[문제 VM 관련]
문제 VM 상의 C:\Logs\ 디렉토리로 이동하면 공격자 행위에 대한 네트워크 로그를 확인하실 수 있습니다.
September 11th, 10:15:17 AM
A-1 A-2 풀었다. 

A-3 조작된 이메일을 복구하면 될거같은데 이게 맞나? 어캐하는거지
13:32 모르겠다 ㅅㅂ 이메일이 조작된거같긴한데 

B-1 이나 풀자.
메일이 몇갠데 악성코드를 분석하래
행동요령 압축파일 다운받았더니 사진이 여러장 나온다.
(? 어디서 본 패턴인데)
사진 1장이 479KB. 용량이 크면 안에 뭐 들어있는거였나.
뭐 파일 나누기 했던거 같은데 뭐썼더라
Suninatas [Forensic] 21번 여기서 봤었던거같다.	칼리리눅스 foremost로 시도해보자.
15:00 칼리리눅스 세팅완료. 
돌려봤다. 아닌거같다. 
...
B1
A문제에서 봤던 공격자가 보낸 이메일의 첨부파일은 다운로드되지 않는다.
아마 이미 감염됬다고 봐야될것같다.
악성코드에 감염된 PC에서 악성코드를 찾으면 되는건가

C2 정답은 피해 VM의 이벤트 로그 시간을 기준으로 한다
이벤트로그의 뭘봐야하는지 모르겠다.
보안로그에 파일생성 로그가 나오나?

download.html로 이동하지만 지금 이동하려고 해도 안들어가진다. 
17:38 와이어샤크와 이미 만들어져있던 패킷으로 추출해서 공격자가 메일로 뿌렸던 한글파일을 획득했다. 
악성코드 드랍퍼 : 3분기-취약점-조치권고
tcp viewer로 전과 후 비교해서 이상한 통신잡아내기.
안댐 안보임.
한글 EPS 취약점을 이용한 공격인것같다.
SSVIEW로 한글파일에 숨어있는 eps 추출하고 
그걸 파이썬으로 압축해제
18:36 일단 진행하고 있긴하지만 ... 현재순위40등. 전체 46팀. 지금까지 푼 문제는 그냥 거저주는 문제 2개(A1,A2)
오늘 배운건 엄청 많고 어떤 방식인지 감을 잡았다. 그래도 ... 

unzlib로 변환했다. 이걸 pe파일로 바꿔야 분석이 가능하고 분석을 해야 이게 뭔 짓을 하고 어디로 연결을 하려고 하는지 알아낼 수 있다.
포스트스크립트.
%가 주석인데 % 뒤에
%!flag is AES128, CBC, Key 0123456789012345, NicYhtnsn5p5D2p7QBNAF6ORbPn6bcGDgxid3Zx5rCUv9GhbXfZngKqbwdOM+XHp
B1번 문제
드랍퍼에서 획득할 수 있는 악성코드를 분석하여 FLAG를 획득하여라
FLAG의 형식은 FLAG{...} 이다
19:07 이거 잘만 하면 이문제는 풀고 가겠다.
AES128 과 CBC는 암호화 방식이고 
키는 0123456789012345
암호문은 NicYhtnsn5p5D2p7QBNAF6ORbPn6bcGDgxid3Zx5rCUv9GhbXfZngKqbwdOM+XHp
aes128 과 cbc 키값은 둘다 0123456789012345
했는데 왜 안될까
v}stOjeU\DX_VGjhW9_do_M4lic1ous_Th1n9s_}
FLAG{...} 형식으로 나오는 거같은데 앞부분이 먼가 깨진건가
다른 주석은 %!PS-Adobe-3.0 EPSF-3.0 단서가 될만하진 않다. 진짜 뭐지.
FLAG{_S0metimes_hW9_do_M4lic1ous_Th1n9s_}
계속 누르다보니 갑자기 됬다.
사이트문제였나보다.		https://www.devglan.com/online-tools/aes-encryption-decryption
07:54 드디어 풀었다..!
200점 탈출! 388점...!
08:00 대회종료
9시까지  보고서 제출해야됨